generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             Int      @id @default(autoincrement())
  email          String   @unique
  name           String
  password       String
  tipo           String   // "estudante" ou "corretor"
  emailVerificado Boolean @default(false)
  fotoPerfil     String?
  descricao      String?
  createdAt      DateTime @default(now())
  // Relações
  redacoesAutor      Essay[]    @relation("RedacoesAutor")
  redacoesCorrigidas Essay[]    @relation("RedacoesCorretor")
  corretor           Corretor?
  estudante          Estudante?
  @@map("users") // <-- Adicione esta linha
}

model Corretor {
  id           Int    @id @default(autoincrement())
  userId       Int    @unique
  user         User   @relation(fields: [userId], references: [id])
  experiencia  String?
  escolaridade String?
  certificado  String?
  aprovado     Boolean? @default(false)
  rating       Float?   @default(0.0) // <-- agora só aqui
}

model Estudante {
  id          Int      @id @default(autoincrement())
  userId      Int      @unique
  user        User     @relation(fields: [userId], references: [id])
  instagram   String?
  interesses  String[]
  // Adicione outros campos exclusivos do estudante aqui, se houver
}

model Essay {
  id           Int      @id @default(autoincrement())
  text         String?
  urlImage     String?
  authorId     Int
  author       User     @relation("RedacoesAutor", fields: [authorId], references: [id])
  corretorId   Int?
  corretor     User?    @relation("RedacoesCorretor", fields: [corretorId], references: [id])
  corrigidaPor String?
  correcaoIa   String?
  tipoCorrecao String?
  tema         String?
  createdAt    DateTime @default(now())
  notaTotal    Float?
}

model Tema {
  id                Int               @id @default(autoincrement())
  tipo              String
  titulo            String
  imagem            String
  instrucoes        String
  proposta          String
  createdAt         DateTime          @default(now())
  textosMotivadores TextoMotivador[]
}

model TextoMotivador {
  id        Int    @id @default(autoincrement())
  tipo      String
  valor     String
  fonte     String?
  temaId    Int
  tema      Tema   @relation(fields: [temaId], references: [id])
}